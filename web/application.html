<html>

    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
        <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.35/dist/web3.min.js"></script>
        <link rel="stylesheet" href="./resources/tfe.css">
        <script src="./resources/tfe.js"></script>
        <script>

            //ABI del contrato ClaimHolder
            const ABI_CH = [{"constant": false,"inputs": [{"name": "_claimType","type": "uint256"},{"name": "_scheme","type": "uint256"},{"name": "_issuer","type": "address"},{"name": "_signature","type": "bytes"},{"name": "_data","type": "bytes"},{"name": "_uri","type": "string"}],"name": "addClaim","outputs": [{"name": "claimRequestId","type": "bytes32"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": false,"inputs": [{"name": "_key","type": "bytes32"},{"name": "_purpose","type": "uint256"},{"name": "_type","type": "uint256"}],"name": "addKey","outputs": [{"name": "success","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": false,"inputs": [{"name": "_id","type": "uint256"},{"name": "_approve","type": "bool"}],"name": "approve","outputs": [{"name": "success","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"anonymous": false,"inputs": [{"indexed": true,"name": "claimRequestId","type": "uint256"},{"indexed": true,"name": "claimType","type": "uint256"},{"indexed": false,"name": "scheme","type": "uint256"},{"indexed": true,"name": "issuer","type": "address"},{"indexed": false,"name": "signature","type": "bytes"},{"indexed": false,"name": "data","type": "bytes"},{"indexed": false,"name": "uri","type": "string"}],"name": "ClaimRequested","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "claimId","type": "bytes32"},{"indexed": true,"name": "claimType","type": "uint256"},{"indexed": true,"name": "issuer","type": "address"},{"indexed": false,"name": "signatureType","type": "uint256"},{"indexed": false,"name": "signature","type": "bytes32"},{"indexed": false,"name": "claim","type": "bytes"},{"indexed": false,"name": "uri","type": "string"}],"name": "ClaimAdded","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "claimId","type": "bytes32"},{"indexed": true,"name": "claimType","type": "uint256"},{"indexed": false,"name": "scheme","type": "uint256"},{"indexed": true,"name": "issuer","type": "address"},{"indexed": false,"name": "signature","type": "bytes"},{"indexed": false,"name": "data","type": "bytes"},{"indexed": false,"name": "uri","type": "string"}],"name": "ClaimAdded","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "claimId","type": "bytes32"},{"indexed": true,"name": "claimType","type": "uint256"},{"indexed": false,"name": "scheme","type": "uint256"},{"indexed": true,"name": "issuer","type": "address"},{"indexed": false,"name": "signature","type": "bytes"},{"indexed": false,"name": "data","type": "bytes"},{"indexed": false,"name": "uri","type": "string"}],"name": "ClaimRemoved","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "claimId","type": "bytes32"},{"indexed": true,"name": "claimType","type": "uint256"},{"indexed": false,"name": "scheme","type": "uint256"},{"indexed": true,"name": "issuer","type": "address"},{"indexed": false,"name": "signature","type": "bytes"},{"indexed": false,"name": "data","type": "bytes"},{"indexed": false,"name": "uri","type": "string"}],"name": "ClaimChanged","type": "event"},{"constant": false,"inputs": [{"name": "_to","type": "address"},{"name": "_value","type": "uint256"},{"name": "_data","type": "bytes"}],"name": "execute","outputs": [{"name": "executionId","type": "uint256"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"anonymous": false,"inputs": [{"indexed": true,"name": "executionId","type": "uint256"},{"indexed": true,"name": "to","type": "address"},{"indexed": true,"name": "value","type": "uint256"},{"indexed": false,"name": "data","type": "bytes"}],"name": "ExecutionFailed","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "key","type": "bytes32"},{"indexed": true,"name": "purpose","type": "uint256"},{"indexed": true,"name": "keyType","type": "uint256"}],"name": "KeyAdded","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "key","type": "bytes32"},{"indexed": true,"name": "purpose","type": "uint256"},{"indexed": true,"name": "keyType","type": "uint256"}],"name": "KeyRemoved","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "executionId","type": "uint256"},{"indexed": true,"name": "to","type": "address"},{"indexed": true,"name": "value","type": "uint256"},{"indexed": false,"name": "data","type": "bytes"}],"name": "ExecutionRequested","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "executionId","type": "uint256"},{"indexed": true,"name": "to","type": "address"},{"indexed": true,"name": "value","type": "uint256"},{"indexed": false,"name": "data","type": "bytes"}],"name": "Executed","type": "event"},{"anonymous": false,"inputs": [{"indexed": true,"name": "executionId","type": "uint256"},{"indexed": false,"name": "approved","type": "bool"}],"name": "Approved","type": "event"},{"constant": false,"inputs": [{"name": "_claimId","type": "bytes32"}],"name": "removeClaim","outputs": [{"name": "success","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": false,"inputs": [{"name": "_key","type": "bytes32"}],"name": "removeKey","outputs": [{"name": "success","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"constant": true,"inputs": [{"name": "_claimId","type": "bytes32"}],"name": "getClaim","outputs": [{"name": "claimType","type": "uint256"},{"name": "scheme","type": "uint256"},{"name": "issuer","type": "address"},{"name": "signature","type": "bytes"},{"name": "data","type": "bytes"},{"name": "uri","type": "string"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [{"name": "_claimType","type": "uint256"}],"name": "getClaimIdsByType","outputs": [{"name": "claimIds","type": "bytes32[]"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [{"name": "_key","type": "bytes32"}],"name": "getKey","outputs": [{"name": "purpose","type": "uint256"},{"name": "keyType","type": "uint256"},{"name": "key","type": "bytes32"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [{"name": "_key","type": "bytes32"}],"name": "getKeyPurpose","outputs": [{"name": "purpose","type": "uint256"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [{"name": "_purpose","type": "uint256"}],"name": "getKeysByPurpose","outputs": [{"name": "_keys","type": "bytes32[]"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [{"name": "_key","type": "bytes32"},{"name": "_purpose","type": "uint256"}],"name": "keyHasPurpose","outputs": [{"name": "result","type": "bool"}],"payable": false,"stateMutability": "view","type": "function"}];

            //ABI del contrato ClaimVerifier
            const ABI_CV = [{"constant": false,"inputs": [{"name": "_identity","type": "address"},{"name": "claimType","type": "uint256"}],"name": "checkClaim","outputs": [{"name": "claimValid","type": "bool"}],"payable": false,"stateMutability": "nonpayable","type": "function"},{"anonymous": false,"inputs": [{"indexed": false,"name": "_identity","type": "address"},{"indexed": false,"name": "claimType","type": "uint256"}],"name": "ClaimValid","type": "event"},{"anonymous": false,"inputs": [{"indexed": false,"name": "_identity","type": "address"},{"indexed": false,"name": "claimType","type": "uint256"}],"name": "ClaimInvalid","type": "event"},{"inputs": [{"name": "_trustedClaimHolder","type": "address"}],"payable": false,"stateMutability": "nonpayable","type": "constructor"},{"constant": true,"inputs": [{"name": "_identity","type": "address"},{"name": "claimType","type": "uint256"}],"name": "claimIsValid","outputs": [{"name": "claimValid","type": "bool"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [{"name": "sig","type": "bytes"},{"name": "dataHash","type": "bytes32"}],"name": "getRecoveredAddress","outputs": [{"name": "addr","type": "address"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [],"name": "trustedClaimHolder","outputs": [{"name": "","type": "address"}],"payable": false,"stateMutability": "view","type": "function"}];

            start();

            /////////////////////////////////////////////////////////////

            // Función para manejar las pestañas
            function clickHandle(evt, nombreEntidad) {
              let i, tabcontent, tablinks;
            
              // This is to clear the previous clicked content.
              tabcontent = document.getElementsByClassName("tabcontent");
              for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
              }
            
              // Set the tab to be "active".
              tablinks = document.getElementsByClassName("tablinks");
              for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
              }
            
              // Display the clicked tab and set it to active.
              document.getElementById(nombreEntidad).style.display = "block";
              evt.currentTarget.className += " active";
            }


        </script>
    </head>
    
    <!--https://www.educative.io/edpresso/how-to-create-tabs-in-html-->
    <body>
        <h3>Contratación de Drones</h3>
            <div class="tab">
                <button class="tablinks" onclick="clickHandle(event, 'principal')">TFE</button>
                <button class="tablinks" onclick="clickHandle(event, 'compania')">Compañia</button>
                <button class="tablinks" onclick="clickHandle(event, 'propietario')">Propietario</button>
            </div>
            <form name="tfeForm">
                <div id="principal" class="tabcontent">
                    <table>
                        <tr>	
                            <td>TFE</td>
                        </tr>
                    </table>
                </div>

                <div id="compania" class="tabcontent">
                    <table style="width:100%">
                        <colgroup>
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                            <col span="1" style="width: 10%;">
                         </colgroup>
                         <!-- Alta de drones -->
                        <tr>
                            <th w>Nombre: </th>
                            <td><input type="text" name="" id=""></td>
                            <th>Atura mínima: </th>
                            <td><input type="text" name="" id=""></td>
                            <th>Altura máxima: </th>
                            <td><input type="text" name="" id=""></td>
                            <th>Coste: </th>
                            <td><input type="text" name="" id=""></td>
                        </tr>
                        <tr>
                            <th>Pesticida: </th>
                            <td colspan="9" align="left">
                                <input type="checkbox" id="cbox1" value="1"> Pesticida A</label>
                                <input type="checkbox" id="cbox2" value="2"> Pesticida B</label>
                                <input type="checkbox" id="cbox3" value="3"> Pesticida C</label>
                                <input type="checkbox" id="cbox4" value="4"> Pesticida D</label>
                                <input type="checkbox" id="cbox5" value="5"> Pesticida E</label>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="10" align="center"><input type="button" name="altaDron" value="ALTA DRON" onclick=""></td>
                        </tr>
                        <tr>
                            <th colspan="10">---------------------------------------------------------------------------------------</th>
                        </tr>
                        <!-- Consulta de drones -->
                        <tr>
                            <th>Consulta Dron: </th>
                            <td>
                                <select name="drones" id="parcelas">
                                    <option value="1">Dron 1</option>
                                    <option value="2">Dron 2</option>
                                </select>
                            </td>
                            <td><input type="button" name="buttonConsultaDron" value="Dron" onclick=""></td>
                            <td colspan="5" align="left"><div id="saldo"></div></td>
                        </tr>
                        <tr>
                            <th colspan="10">---------------------------------------------------------------------------------------</th>
                        </tr>
                        <!-- Consulta de Saldo -->
                        <tr>
                            <th>Consulta Saldo: </th>
                            <td><input type="button" name="buttonSaldoC" value="Saldo" onclick=""></td>
                            <td colspan="8" align="left"><div id="saldo"></div></td>
                        </tr>
                        <tr>
                            <th colspan="10">---------------------------------------------------------------------------------------</th>
                        </tr>
                        <!-- Asignar trabajos -->
                        <tr>
                            <td colspan="2" align="center">Trabajos Solicitados: </td>
                            <td colspan="3" align="center">
                                <select name="trabajos" id="trabajos">
                                    <option value="1">Trabajo 1</option>
                                    <option value="2">Trabajo 2</option>
                                </select>
                            </td>
                            <td colspan="5" align="center"><div id="carTrabajo"></div></td>
                        </tr>
                        <tr>
                            <td colspan="10" align="center"><input type="button" name="asignarTrabajo" value="Asignar Trabajo" onclick=""></td>
                        </tr>
                    </table>
                </div>

                <div id="propietario" class="tabcontent">
                    <table style="width:100%">
                        <colgroup>
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                            <col span="1" style="width: 13%;">
                         </colgroup>
                        <tr>
                            <th w>Nombre: </th>
                            <td><input type="text" name="" id=""></td>
                            <th>Atura mínima: </th>
                            <td><input type="text" name="" id=""></td>
                            <th>Altura máxima: </th>
                            <td><input type="text" name="" id=""></td>
                            <th>Pesticida: </th>
                            <td colspan="7">
                                <select name="pesticida" id="pesticida">
                                    <option value="1">Pesticida A</option>
                                    <option value="2">Pesticida B</option>
                                    <option value="3">Pesticida C</option>
                                    <option value="4">Pesticida D</option>
                                    <option value="5">Pesticida E</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="10" align="center"><input type="button" name="altaDron" value="ALTA PARCELA" onclick=""></td>
                        </tr>
                        <tr>
                            <th colspan="10">---------------------------------------------------------------------------------------</th>
                        </tr>
                        <tr>
                            <th>Consulta Saldo: </th>
                            <td><input type="button" name="consultaSaldo" value="Saldo" onclick=""></td>
                            <td colspan="8" align="left"><div id="saldo"></div></td>
                        </tr>
                        <tr>
                            <th colspan="10">---------------------------------------------------------------------------------------</th>
                        </tr>
                        <tr>
                            <td colspan="2" align="center">Parcela: </td>
                            <td colspan="3" align="center">
                                <select name="parcelas" id="parcelas">
                                    <option value="1">Parcela 1</option>
                                    <option value="2">Parcela 2</option>
                                </select>
                            </td>
                            <td colspan="2" align="center">Dron: </td>
                            <td colspan="3" align="center">
                                <select name="drones" id="parcelas">
                                    <option value="1">Dron 1</option>
                                    <option value="2">Dron 2</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="5" align="center"><div id="carParcela"></div></td>
                            <td colspan="5" align="canter"><div id="carDron"></div></td>
                        </tr>
                        <tr>
                            <td colspan="10" align="center"><input type="button" name="contratar" value="Contratar DRON" onclick=""></td>
                        </tr>
                    </table>
                </div>
            </form>

            <!-- Zona de muestra de resultados -->
            <div id="console"></div>
     </body>
</html>